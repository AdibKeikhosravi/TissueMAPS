<form ng-init="stage = stageCtrl.stage">
  <div class="col-md-12">
    <div ng-repeat="step in stage.steps">
      <div class="panel panel-default">
        <div class="panel-heading">
          {{:: step.name }}
        </div>
        <div class="panel-body">

          <h4>Batch arguments</h4>
          <tm-argument-input arg="arg" ng-repeat="arg in step.batch_args"
              arg-collection="setupCtrl.args[stage.name][step.name].batch_args"></tm-argument-input>

          <h4>Submit arguments</h4>
          <tm-argument-input arg="arg" ng-repeat="arg in step.submission_args"
              arg-collection="setupCtrl.args[stage.name][step.name].submission_args"></tm-argument-input>

          <h4>Extra arguments</h4>
          <tm-argument-input arg="arg" ng-repeat="arg in step.extra_args"
              arg-collection="setupCtrl.args[stage.name][step.name].extra_args"></tm-argument-input>

          <div ng-show="stage.name == 'image_analysis'">
              <button class="btn btn-default"
                  ng-click="setupCtrl.editPipeline(step)"
                  ng-disabled="!setupCtrl.canModifyPipeline()">
                <i class="fa fa-pencil-square-o" aria-hidden="true"></i>
                Edit
              </button>
              <button class="btn btn-default"
                  ng-click="setupCtrl.deletePipeline(step)"
                  ng-disabled="!setupCtrl.canModifyPipeline()">
                <i class="fa fa-trash-o" aria-hidden="true"></i>
                Delete
              </button>
              <button class="btn btn-default"
                  ng-click="setupCtrl.createPipeline()"
                  ng-disabled="!setupCtrl.canModifyPipeline()">
                Create new
              </button>
          </div>

        </div>
      </div>
    </div>

    <button ng-click="setupCtrl.submit()"
        ng-disabled="!setupCtrl.canSubmit()"
        class="btn btn-primary">
        Submit
    </button>

    <button ng-click="setupCtrl.resume()"
        ng-disabled="!setupCtrl.canResubmit()"
        class="btn btn-primary">
        Resume
    </button>

    <button ng-click="setupCtrl.resubmit()"
        ng-disabled="!setupCtrl.canResubmit()"
        class="btn btn-primary">
        Resubmit
    </button>

    <button ng-click="setupCtrl.kill()"
        ng-disabled="!setupCtrl.isRunning()"
        class="btn btn-default">
        <i class="fa fa-stop"></i>
        Kill
    </button>

    <button ng-click="setupCtrl.save()"
        ng-disabled="setupCtrl.isRunning()"
        class="btn btn-default">
        <i class="fa fa-floppy-o"></i>
        Save
    </button>

    <button ng-click="setupCtrl.update()"
        class="btn btn-default">
        <i class="fa fa-refresh"></i>
        Reload
    </button>

  </div>
</form>


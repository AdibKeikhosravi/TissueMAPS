<div class="topbar" ng-controller="TopbarCtrl as topbar">

  <ul class="button-list" ng-show="app.isUserAuthenticated()">
    <li ui-sref="viewport.userpanel">
      <a>
        <i class="fa fa-user"></i>
      </a>
    </li><li
      ng-click="topbar.appstateService.saveState()"
      ng-hide="topbar.appstateService.currentState.isSnapshot">
      <i class="fa fa-floppy-o"></i>
    </li><li
      class="save-as-button"
      ng-click="topbar.appstateService.promptForSaveAs()"
      ng-hide="topbar.appstateService.currentState.isSnapshot">
      <i class="fa fa-floppy-o"></i>
      <i class="fa fa-pencil"></i>
    </li><li
      ng-click="topbar.appstateService.shareState()"
      ng-hide="topbar.appstateService.currentState.isSnapshot">
      <i class="fa fa-globe"></i>
    </li>
  </ul>

  <!-- <div class="spacer"></div> -->

  <span class="session-label">
    <b>
      {{ topbar.appstateService.currentState.name || 'unnamed session' }}
    </b>
  </span>

  <span class="session-info"
        ng-show="topbar.appstateService.lastSavedAt">
    (saved {{ topbar.appstateService.lastSavedAt | moment: 'fromNow' }})
  </span>

  <span class="session-info" ng-show="topbar.appstateService.currentState.isSnapshot">
    <b>VIEWING SNAPSHOT</b>
    (session can't be saved)
  </span>

  <div class="user-indicator">

    <div ng-show="app.isUserAuthenticated()">
      <a ui-sref="viewport.userpanel">
        <b>{{ app.getUser().name}}</b>
      </a>
      <a ui-sref="welcome" ng-click="app.logout()">(logout)</a>
    </div>

    <div ng-show="!app.isUserAuthenticated()">
      <tm-inline-login-form></tm-inline-login-form>
    </div>
  </div>

</div>
